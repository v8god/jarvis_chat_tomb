<!DOCTYPE html>
<html>
<head>
    <title>Jarvis Chat</title>
    <style>
        body { background: #0b0f1a; color: #fff; font-family: Arial; margin: 0; padding: 0; }
        #chatbox { height: 80vh; overflow-y: auto; padding: 10px; background: #1a1a2e; }
        .msg { margin: 5px 0; padding: 10px; border-radius: 8px; max-width: 70%; }
        .You { background: #00aaff; color: white; align-self: flex-end; }
        .Jarvis { background: #444; color: #fff; align-self: flex-start; }
        .System { background: #888; color: #000; font-size: 12px; align-self: center; }
        #controls { padding: 10px; background: #16213e; display: flex; align-items: center; }
        input { flex: 1; padding: 8px; }
        button, select { margin-left: 5px; padding: 8px; }
    </style>
</head>
<body>
    <div id="chatbox"></div>
    <div id="controls">
        <select id="modeSelect" onchange="changeMode()">
            <option value="voice">Speak</option>
            <option value="text">Type</option>
        </select>
        <input type="text" id="cmd" placeholder="Type command..." />
        <button onclick="sendCommand()">Send</button>
    </div>

    <script>
        function updateLogs() {
            fetch("/logs").then(r=>r.json()).then(data=>{
                let chatbox = document.getElementById("chatbox");
                data.logs.forEach(log => {
                    let div = document.createElement("div");
                    div.className = "msg " + log.sender;
                    div.innerText = log.sender + ": " + log.text;
                    chatbox.appendChild(div);
                    chatbox.scrollTop = chatbox.scrollHeight;
                });
            });
        }
        function sendCommand() {
            let cmd = document.getElementById("cmd").value;
            fetch("/send_command", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({cmd: cmd})
            });
            document.getElementById("cmd").value = "";
        }
        function changeMode() {
            let mode = document.getElementById("modeSelect").value;
            fetch("/set_mode", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({mode: mode})
            });
        }
        setInterval(updateLogs, 500);
    </script>
</body>
</html>
